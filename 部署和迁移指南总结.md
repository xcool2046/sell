# Sellsys éƒ¨ç½²å’Œè¿ç§»æŒ‡å—æ€»ç»“

## ğŸ“‹ æ–‡æ¡£æ¦‚è§ˆ

æœ¬é¡¹ç›®æä¾›äº†å®Œæ•´çš„æœåŠ¡å™¨éƒ¨ç½²å’Œè¿ç§»è§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«ä»¥ä¸‹å·¥å…·å’Œæ–‡æ¡£ï¼š

### ğŸ“š æ–‡æ¡£æ–‡ä»¶
1. **æœåŠ¡å™¨è¿ç§»æ•™ç¨‹.md** - è¯¦ç»†çš„è¿ç§»æ­¥éª¤æŒ‡å—
2. **éƒ¨ç½²å’Œè¿ç§»æŒ‡å—æ€»ç»“.md** - æœ¬æ–‡æ¡£ï¼Œæä¾›å¿«é€Ÿå‚è€ƒ

### ğŸ› ï¸ è‡ªåŠ¨åŒ–å·¥å…·
1. **quick-migration.sh** - Linux/Mac å¿«é€Ÿè¿ç§»è„šæœ¬
2. **update-server-address.sh** - Linux/Mac æœåŠ¡å™¨åœ°å€æ›´æ–°å·¥å…·
3. **update-server-windows.bat** - Windows æœåŠ¡å™¨åœ°å€æ›´æ–°å·¥å…·

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åœºæ™¯1ï¼šå®Œæ•´æœåŠ¡å™¨è¿ç§»
```bash
# ä¸€é”®å®Œæˆä»æ—§æœåŠ¡å™¨åˆ°æ–°æœåŠ¡å™¨çš„å®Œæ•´è¿ç§»
./quick-migration.sh full-migration æ—§æœåŠ¡å™¨IP æ–°æœåŠ¡å™¨IP

# ç¤ºä¾‹
./quick-migration.sh full-migration 8.156.69.42 192.168.1.100
```

### åœºæ™¯2ï¼šä»…æ›´æ–°å®¢æˆ·ç«¯æœåŠ¡å™¨åœ°å€
```bash
# Linux/Mac
./update-server-address.sh æ–°æœåŠ¡å™¨IP [ç«¯å£]

# Windows
update-server-windows.bat æ–°æœåŠ¡å™¨IP [ç«¯å£]

# ç¤ºä¾‹
./update-server-address.sh 192.168.1.100
update-server-windows.bat 192.168.1.100 5000
```

### åœºæ™¯3ï¼šåˆ†æ­¥éª¤è¿ç§»
```bash
# æ­¥éª¤1ï¼šå¤‡ä»½æ—§æœåŠ¡å™¨
./quick-migration.sh backup æ—§æœåŠ¡å™¨IP

# æ­¥éª¤2ï¼šéƒ¨ç½²åˆ°æ–°æœåŠ¡å™¨
./quick-migration.sh deploy æ–°æœåŠ¡å™¨IP

# æ­¥éª¤3ï¼šæ›´æ–°å®¢æˆ·ç«¯
./quick-migration.sh update-client æ–°æœåŠ¡å™¨IP
```

---

## ğŸ“ é¡¹ç›®ç»“æ„è¯´æ˜

```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ src/                           # æºä»£ç 
â”‚   â”œâ”€â”€ Sellsys.WebApi/           # åç«¯API
â”‚   â””â”€â”€ Sellsys.WpfClient/        # WPFå®¢æˆ·ç«¯
â”œâ”€â”€ deploy-package/               # æœåŠ¡å™¨éƒ¨ç½²åŒ…
â”‚   â”œâ”€â”€ webapi-selfcontained/     # è‡ªåŒ…å«APIç¨‹åº
â”‚   â”œâ”€â”€ deploy.sh                 # éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ setup-environment.sh     # ç¯å¢ƒé…ç½®è„šæœ¬
â”œâ”€â”€ publish/                      # ç¼–è¯‘è¾“å‡ºç›®å½•
â”œâ”€â”€ backup/                       # æ•°æ®å¤‡ä»½ç›®å½•
â”œâ”€â”€ æœåŠ¡å™¨è¿ç§»æ•™ç¨‹.md              # è¯¦ç»†è¿ç§»æŒ‡å—
â”œâ”€â”€ quick-migration.sh            # å¿«é€Ÿè¿ç§»è„šæœ¬
â”œâ”€â”€ update-server-address.sh      # åœ°å€æ›´æ–°å·¥å…·(Linux)
â””â”€â”€ update-server-windows.bat     # åœ°å€æ›´æ–°å·¥å…·(Windows)
```

---

## ğŸ”§ å…³é”®é…ç½®æ–‡ä»¶

### å®¢æˆ·ç«¯APIé…ç½®
**æ–‡ä»¶**: `src/Sellsys.WpfClient/Services/ApiService.cs`
```csharp
// éœ€è¦ä¿®æ”¹çš„è¡Œ
private const string ProductionUrl = "http://æœåŠ¡å™¨IP:5000/api";
```

### æœåŠ¡å™¨é…ç½®
**æ–‡ä»¶**: `deploy-package/webapi-selfcontained/appsettings.json`
```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Data Source=sellsys.db"
  }
}
```

---

## âš¡ å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

### æœåŠ¡å™¨ç®¡ç†
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status sellsys-webapi

# é‡å¯æœåŠ¡
sudo systemctl restart sellsys-webapi

# æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u sellsys-webapi -f

# æµ‹è¯•API
curl http://æœåŠ¡å™¨IP:5000/health
```

### æ•°æ®åº“å¤‡ä»½
```bash
# å¤‡ä»½æ•°æ®åº“
sudo cp /opt/sellsys/sellsys.db /opt/sellsys/backup/sellsys_$(date +%Y%m%d_%H%M%S).db

# æ¢å¤æ•°æ®åº“
sudo systemctl stop sellsys-webapi
sudo cp backup/sellsys_backup.db /opt/sellsys/sellsys.db
sudo chown sellsys:sellsys /opt/sellsys/sellsys.db
sudo systemctl start sellsys-webapi
```

### å®¢æˆ·ç«¯ç¼–è¯‘
```bash
# ç¼–è¯‘Releaseç‰ˆæœ¬
dotnet publish src/Sellsys.WpfClient/Sellsys.WpfClient.csproj \
    -c Release \
    -o publish/wpfclient-new \
    --self-contained true \
    -r win-x64
```

---

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æœåŠ¡æ— æ³•å¯åŠ¨
```bash
# æ£€æŸ¥æ—¥å¿—
sudo journalctl -u sellsys-webapi --no-pager -n 20

# æ£€æŸ¥ç«¯å£å ç”¨
sudo netstat -tlnp | grep :5000

# æ£€æŸ¥æ–‡ä»¶æƒé™
sudo chown -R sellsys:sellsys /opt/sellsys
sudo chmod +x /opt/sellsys/Sellsys.WebApi
```

#### 2. å®¢æˆ·ç«¯è¿æ¥å¤±è´¥
- æ£€æŸ¥æœåŠ¡å™¨IPåœ°å€æ˜¯å¦æ­£ç¡®
- ç¡®è®¤æœåŠ¡å™¨é˜²ç«å¢™å¼€æ”¾5000ç«¯å£
- æµ‹è¯•ç½‘ç»œè¿é€šæ€§ï¼š`ping æœåŠ¡å™¨IP`
- æµ‹è¯•APIï¼š`curl http://æœåŠ¡å™¨IP:5000/health`

#### 3. æ•°æ®ä¸¢å¤±
- æ£€æŸ¥å¤‡ä»½ç›®å½•ï¼š`/opt/sellsys/backup/`
- æ¢å¤æœ€æ–°å¤‡ä»½
- æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶æƒé™

---

## ğŸ“ æŠ€æœ¯æ”¯æŒæ¸…å•

### è¿ç§»å‰å‡†å¤‡
- [ ] ç¡®è®¤æ–°æœåŠ¡å™¨æ»¡è¶³ç³»ç»Ÿè¦æ±‚
- [ ] å¤‡ä»½å½“å‰æœåŠ¡å™¨æ‰€æœ‰æ•°æ®
- [ ] é€šçŸ¥ç”¨æˆ·è¿ç§»æ—¶é—´å®‰æ’
- [ ] å‡†å¤‡æ–°æœåŠ¡å™¨è®¿é—®æƒé™

### è¿ç§»è¿‡ç¨‹æ£€æŸ¥
- [ ] æ•°æ®åº“å¤‡ä»½å®Œæˆ
- [ ] æ–°æœåŠ¡å™¨ç¯å¢ƒé…ç½®å®Œæˆ
- [ ] åº”ç”¨éƒ¨ç½²æˆåŠŸ
- [ ] æ•°æ®æ¢å¤å®Œæˆ
- [ ] APIæ¥å£æµ‹è¯•é€šè¿‡
- [ ] å®¢æˆ·ç«¯é…ç½®æ›´æ–°
- [ ] æ–°å®¢æˆ·ç«¯ç¼–è¯‘æˆåŠŸ

### è¿ç§»åéªŒè¯
- [ ] æœåŠ¡å™¨è¿è¡ŒçŠ¶æ€æ­£å¸¸
- [ ] æ•°æ®å®Œæ•´æ€§æ£€æŸ¥
- [ ] ç”¨æˆ·åŠŸèƒ½æµ‹è¯•
- [ ] æ€§èƒ½ç›‘æ§
- [ ] å¤‡ä»½ç­–ç•¥ç¡®è®¤

---

## ğŸ“ˆ æœ€ä½³å®è·µ

### è¿ç§»æ—¶æœº
- é€‰æ‹©ä¸šåŠ¡ä½å³°æœŸè¿›è¡Œè¿ç§»
- é¢„ç•™å……è¶³çš„æ—¶é—´çª—å£
- å‡†å¤‡å›æ»šæ–¹æ¡ˆ

### æ•°æ®å®‰å…¨
- è¿ç§»å‰å®Œæ•´å¤‡ä»½
- éªŒè¯å¤‡ä»½å®Œæ•´æ€§
- ä¿ç•™å¤šä¸ªå†å²å¤‡ä»½

### ç”¨æˆ·ä½“éªŒ
- æå‰é€šçŸ¥ç”¨æˆ·
- æä¾›è¯¦ç»†çš„æ›´æ–°è¯´æ˜
- å‡†å¤‡æŠ€æœ¯æ”¯æŒ

### ç›‘æ§å’Œç»´æŠ¤
- è®¾ç½®æœåŠ¡ç›‘æ§
- å®šæœŸå¤‡ä»½æ•°æ®
- ç›‘æ§ç³»ç»Ÿæ€§èƒ½

---

## ğŸ“ ç‰ˆæœ¬è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|------|------|----------|
| 1.0 | 2025-07-26 | åˆå§‹ç‰ˆæœ¬ï¼ŒåŒ…å«å®Œæ•´è¿ç§»æ–¹æ¡ˆ |

---

## ğŸ“§ è”ç³»ä¿¡æ¯

å¦‚éœ€æŠ€æœ¯æ”¯æŒï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
- æœåŠ¡å™¨IPåœ°å€å’Œæ“ä½œç³»ç»Ÿç‰ˆæœ¬
- é”™è¯¯ä¿¡æ¯å’Œæ—¥å¿—
- æ“ä½œæ­¥éª¤æè¿°
- ç³»ç»Ÿç¯å¢ƒä¿¡æ¯

**é‡è¦æé†’**ï¼šåœ¨è¿›è¡Œä»»ä½•è¿ç§»æ“ä½œå‰ï¼Œè¯·åŠ¡å¿…å¤‡ä»½æ‰€æœ‰é‡è¦æ•°æ®ï¼
