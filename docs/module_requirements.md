# 销售信息管理系统 - 模块功能需求文档 (最终版)

## 1. 总览

### 1.1. 目标
本文档旨在详细定义销售信息管理系统的各项功能需求，作为后续开发、测试和验收的唯一依据。

### 1.2. 技术栈
- **前端客户端**: WPF (C# / .NET)
- **后端服务**: ASP.NET Core Web API (C# / .NET)
- **数据库**: MySQL
- **通信协议**: RESTful API (JSON)

### 1.3. 总体设计
系统采用C/S架构，由Windows桌面客户端和部署在云端的后台服务组成。界面风格遵循提供的原型图，主要功能通过左侧导航栏的八大模块提供。所有新增、编辑等操作均以弹窗形式呈现。

### 1.4. 权限与认证
- **模型**: 采用基于角色的访问控制 (RBAC)。
- **角色**: 系统内的“岗位职务”即为角色。
- **数据权限**: 为简化开发，默认不进行严格的数据隔离。拥有模块访问权限的用户，可以看到该模块下的所有数据。
- **认证开发策略**: 认证与登录功能将在项目后期实现。开发阶段，客户端将无需登录即可访问所有已开发的API功能。初始管理员账号/密码均为 `admin`。

---

## 2. 模块功能详述

### 2.1. 数据视窗
- **状态**: 本期不做。

### 2.2. 客户管理

#### 2.2.1. 主界面
- **功能**: 展示、搜索、管理所有客户信息。
- **搜索/过滤字段**: `客户名称`, `行业类别`, `省份`, `城市`, `联系状态`, `负责人`。
- **列表字段**: `行业类别`, `城市`, `客户单位名称`, `联系人` (蓝色数字), `客户意向`, `待办`, `负责人`, `创建时间`。
- **列表操作**:
    - `编辑`, `删除` (按钮)。
    - **点击“联系人”列的蓝色数字**: 弹出“查看联系人”弹窗。
- **页面操作**: `添加客户`, `分配给销售`, `分配客服` (按钮)。

#### 2.2.2. 添加/编辑客户 (弹窗)
- **字段**:
  - `行业类别`: **支持多选**的下拉框。
  - `客户单位`: 文本。
  - `省份`/`城市`: 级联下拉框。
  - `详细地址`: 文本。
  - `客户备注`: 文本域。
  - **联系人列表**:
    - 一个客户可以关联**多个联系人**。
    - 每行包含 `联系人姓名`(文本), `电话`(文本), `是否关键联系人`(复选框)。
    - 提供“+”按钮动态添加新的联系人行。
  - **业务规则**:
    - **客户名称**为必填项。
    - **必须至少包含一个联系人**才能成功创建新客户。如果用户没有添加任何联系人就点击保存，系统应提示“请至少添加一位联系人”。

#### 2.2.3. 分配销售/分配客服 (弹窗)
- **功能**: 为选中的客户分配负责人。
- **字段**: `部门名称`, `组别名称`, `销售姓名` / `客服姓名` (均为级联下拉选择)。

### 2.3. 销售管理

#### 2.3.1. 主界面
- **功能**: 此模块是客户管理的另一个视图，侧重于销售跟进。
- **列表字段**: `序号`, `省份`, `城市`, `客户单位`, `联系人` (蓝色数字), `联系状态`, `客户意向`, `订单` (蓝色数字), `下次跟进日期`, `销售人`, `更新时间`。
- **列表操作**:
    - `跟进记录`, `订单记录` (按钮)。
    - **点击“联系人”列的蓝色数字**: 弹出“查看联系人”弹窗 (复用客户管理的功能)。
    - **点击“订单”列的蓝色数字**: 弹出“订单记录”弹窗。

#### 2.3.2. 跟进记录 (弹窗)
- **交互**: 点击主界面的“跟进记录”按钮，弹出一个包含**跟进记录列表**和“添加记录”按钮的**父弹窗**。
- **父弹窗-列表字段**: `序号`, `联系人`, `联系电话`, `联系概要`, `客户意向`, `下次跟进时间`, `销售`。
- **父弹窗-操作**: 点击“添加记录”按钮，弹出**子弹窗**。
- **子弹窗 (添加联系记录)**:
  - `联系人`: 从该客户的联系人列表中下拉选择。
  - `联系概要`: 文本域。
  - `下次跟进时间`: 日期选择器。
  - `客户意向`: (高, 中, 低, 无) 单选。

### 2.4. 订单管理

#### 2.4.1. 主界面
- **功能**: 管理所有销售订单。
- **搜索/过滤字段**: `客户名称`, `产品名称`, `生效日期`, `到期日期`, `订单状态`, `销售人`。
- **列表字段**: `序号`, `客户单位`, `产品名称`, `型号规格`, `产品定价`, `实际售价`, `数量`, `单位`, `订单金额`, `生效日期`, `到期日期`, `销售人`, `订单状态`。
- **页面操作**: `添加订单`。
- **特色功能**:
  - **列表合计**: 在数据表格的底部，提供一个固定的“合计”行，用于动态计算当前显示的所有订单的 `实际售价`, `数量`, `订单金额` 的总和。

#### 2.4.2. 添加/编辑订单 (弹窗)
- **交互**: 这是一个包含多个输入字段的弹窗。
- **字段**:
  - `订单编号`: 自动生成。
  - `客户名称`: 文本框，但**不可编辑**，在创建时已关联。
  - **产品选择**:
      - `产品名称`字段旁有一个“选择”按钮。
      - 点击“选择”按钮，会弹出“选择产品”的**子弹窗**。
      - “选择产品”子弹窗是一个带**单选框**的产品列表，选中后关闭，并将产品信息填充回父弹窗。
  - `实际售价`, `数量`, `订单金额`: 文本/数字输入。
  - `订单状态`: (待收款, 已收款, 已到期) 单选。

### 2.5. 售后服务

#### 2.5.1. 主界面
- **功能**: 展示、搜索所有客户的售后服务信息。
- **搜索/过滤字段**: `客户单位名称`, `客服`, `处理状态`。
- **列表字段**: `序号`, `省份`, `城市`, `客户单位名称`, `联系人` (蓝色数字), `销售`, `客服`, `客服记录` (蓝色数字), `更新时间`。
- **列表操作**:
    - `客服记录` (按钮)。
    - **点击“客服记录”列的蓝色数字或“客服记录”按钮**: 弹出“客服记录”父弹窗。

#### 2.5.2. 客服记录 (父弹窗)
- **交互**: 点击主界面的“客服记录”后，弹出一个包含**客服记录列表**的父弹窗。
- **父弹窗-列表字段**: `序号`, `联系人`, `联系电话`, `客户反馈`, `售后回复`, `处理时间`, `处理状态`, `客服`, `操作`。
- **父弹窗-列表操作**: `编辑`, `删除` (按钮)。
- **父弹窗-页面操作**: `添加记录` (按钮)，点击后弹出“添加/编辑反馈”子弹窗。

#### 2.5.3. 添加/编辑反馈 (子弹窗)
- **功能**: 添加或编辑一条具体的客户反馈与处理记录。
- **字段**:
  - `客户单位`: 文本，不可编辑。
  - `联系人姓名`: 文本，不可编辑。
  - `联系电话`: 文本，不可编辑。
  - `客户反馈`: 文本域。
  - `反馈回复`: 文本域。
  - `处理状态`: (待处理, 处理中, 处理完成) 单选框。

### 2.6. 产品管理

#### 2.6.1. 主界面
- **功能**: 管理公司销售的产品信息。
- **页面操作**: `添加产品`。
- **列表字段**: `序号`, `产品名称`, `型号规格`, `计量单位`, `产品定价`, `最低售价`, `销售提成`, `主管提成`, `经理提成`。
- **操作**: `编辑`, `删除`。

#### 2.6.2. 添加/编辑产品 (弹窗)
- **字段**: 与列表字段一一对应，均为可编辑的文本或数字输入框。

### 2.7. 财务管理

#### 2.7.1. 主界面 (订单列表)
- **功能**: 从财务视角展示、筛选和管理所有订单，侧重于收款和提成信息。
- **子模块**: `订单列表`, `订单统计` (本期不做)。
- **搜索/过滤字段**: `客户名称`, `产品名称`, `生效日期`, `到期日期`, `签单日期`, `订单状态`, `销售人`。
- **列表字段**: `序号`, `客户单位`, `产品名称`, `型号规格`, `产品定价`, `实际售价`, `数量`, `单位`, `订单金额`, `销售提成`, `主管提成`, `经理提成`, `签单日期`, `销售人`, `订单状态`, `到账日期`。
- **列表操作**:
    - `确认收款` (按钮)。点击后，更新订单状态和到账日期。
- **特色功能**:
  - **列表合计**: 列表底部提供合计行，动态计算 `订单金额`, `销售提成`, `主管提成`, `经理提成` 的总和。

### 2.8. 系统设置

#### 2.8.1. 部门管理
- **子功能**: `部门管理`, `部门分组`, `员工管理`, `用户权限`。
- **“添加部门” (弹窗)**: `部门名称` (文本)。
- **“添加分组” (弹窗)**: `部门名称`(下拉选择), `部门分组` (文本)。

#### 2.8.2. 员工管理
- **列表字段**: `序号`, `部门名称`, `部门分组`, `员工姓名`, `岗位职务`, `网点账号`, `登录账号`, `创建时间`。
- **“添加员工” (弹窗)**:
  - `部门名称`, `部门分组`: 级联下拉选择。
  - `员工姓名`: 文本输入。
  - `电话号码`: 文本输入。
  - `岗位职务`: 下拉选择。
  - `登录账号`: 文本输入。
  - `初始密码`: 文本输入，默认为 `abc12345`。

#### 2.8.3. 用户权限
- **列表字段**: `序号`, `部门名称`, `岗位职务`, `创建时间`。
- **页面操作**: `添加权限`。
- **“添加/编辑权限” (弹窗)**:
  - **功能**: 为指定的“岗位职务”(角色)分配其可以访问的系统模块。
  - **字段**:
    - `部门名称`: 下拉选择 (用于筛选岗位)。
    - `岗位职务`: 下拉选择 (根据所选部门联动筛选)。
    - `操作权限`: 包含所有模块名称的**复选框列表** (e.g., `□ 客户管理`, `□ 订单管理` ...)。
  - **交互**: 选择岗位后，弹窗会加载并勾选该岗位当前拥有的权限。修改勾选后保存即可更新。